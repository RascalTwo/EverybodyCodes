import { describe, expect, test } from 'vitest'

function dijkstra(graph: Record<string, string[]>, start: string) {
	const distances: Record<string, number> = {};
	for (const node in graph) {
		distances[node] = Infinity;
	}
	distances[start] = 0;

	const unvisited = new Set(Object.keys(graph));
	while (unvisited.size) {
		let node = null;
		for (const otherNode of unvisited) {
			if (!node || distances[otherNode] < distances[node]) node = otherNode
		}
		if (node === null) break;

		unvisited.delete(node);

		for (const neighbor of graph[node]) {
			distances[neighbor] = Math.min(distances[neighbor], distances[node] + 1)
		}
	}

	return distances;
}
const DIRECTIONS = [[1, 0], [-1, 0], [0, 1], [0, -1]]

function solveQuest(notes: string) {
	const world = notes.split('\n').map(l => [...l]);
	let start;
	for (let c = 0; c < world[0].length; c++) {
		if (world[0][c] === '.') {
			start = { r: 0, c }
			break;
		}
	}

	const herbs = []
	for (let r = 0; r < world.length; r++) {
		for (let c = 0; c < world[0].length; c++) {
			if (world[r][c] === 'H') herbs.push({ r, c })
		}
	}

	const graph = {}
	for (let r = 0; r < world.length; r++) {
		for (let c = 0; c < world[0].length; c++) {
			const fromKey = r + '|' + c;
			if (!(fromKey in graph)) graph[fromKey] = []
			for (const [ro, co] of DIRECTIONS) {
				const [nr, nc] = [r + ro, c + co]
				const toChar = world[nr]?.[nc]
				if (!toChar || toChar === '#') continue
				graph[fromKey].push(nr + '|' + nc)
			}
		}
	}

	const distances = dijkstra(graph, start.r + '|' + start.c)

	let closest = Number.MAX_SAFE_INTEGER;
	for (const herb of herbs) {
		closest = Math.min(closest, distances[herb.r + '|' + herb.c])
	}
	return closest * 2
}

function solveQuest2(world: string[][], start?: { r: number, c: number }) {
	if (!start) {
		for (let c = 0; c < world[0].length; c++) {
			if (world[0][c] === '.') {
				start = { r: 0, c }
				break;
			}
		}
	}
	const end = start

	const herbs = {}
	for (let r = 0; r < world.length; r++) {
		for (let c = 0; c < world[0].length; c++) {
			const char = world[r][c]
			if (char >= 'A' && char <= 'Z') {
				if (!(char in herbs)) herbs[char] = []
				herbs[char].push({ r, c, type: char })
			}
		}
	}

	const graph = {}
	for (let r = 0; r < world.length; r++) {
		for (let c = 0; c < world[0].length; c++) {
			const fromKey = r + '|' + c;
			if (!(fromKey in graph)) graph[fromKey] = []
			for (const [ro, co] of DIRECTIONS) {
				const [nr, nc] = [r + ro, c + co]
				const toChar = world[nr]?.[nc]
				if (!toChar || toChar === '#' || toChar === '~') continue
				graph[fromKey].push(nr + '|' + nc)
			}
		}
	}

	let shortestPath = Number.MAX_SAFE_INTEGER;
	let paths = [{
		path: [{ loc: start, traveled: 0 }],
		herbTypesNeeded: new Set(Object.keys(herbs)),
		totalTraveled: 0
	}]
	const distancesFrom = {}
	while (paths.length) {
		let { path, herbTypesNeeded, totalTraveled } = paths.pop()
		let { loc } = path.at(-1);
		const nexts = [];
		for (const herbType in herbs) {
			if (!herbTypesNeeded.has(herbType)) continue
			nexts.push(...herbs[herbType])
		}
		let isFinalTravel = false
		if (!nexts.length) {
			nexts.push(end)
			isFinalTravel = true;
		}
		const from = loc.r + '|' + loc.c
		if (!(from in distancesFrom)) distancesFrom[from] = dijkstra(graph, loc.r + '|' + loc.c)
		const distances = distancesFrom[from];
		nexts.sort((a, b) => distances[b.r + '|' + b.c] - distances[a.r + '|' + a.c])
		const newPaths = nexts.map(next => {
			const traveled = distances[next.r + '|' + next.c]
			const newPath = [...path, { loc: next, traveled }]

			const newHerbTypesNeeded = new Set(herbTypesNeeded)
			newHerbTypesNeeded.delete(next.type)

			return { path: newPath, herbTypesNeeded: newHerbTypesNeeded, totalTraveled: totalTraveled + traveled }
		})
		if (isFinalTravel) {
			const totalDistance = newPaths[0].totalTraveled
			if (totalDistance < shortestPath) {
				shortestPath = totalDistance
				paths = paths.filter(path => path.totalTraveled <= shortestPath)
			}
		} else {
			paths.push(...newPaths.filter(path => path.totalTraveled <= shortestPath))
		}
	}

	return shortestPath
}

function solveQuest3(notes: string) {
	const world = notes.split('\n')
	const rowCount = world.length
	const colCount = world[0].length / 3;
	const worlds = []
	for (let w = 0; w < 3; w++) {
		worlds.push(world.map(row => row.slice(w * colCount, (w + 1) * colCount)));
	}

	// replace bottom herbs
	worlds[0][rowCount - 2] = worlds[0][rowCount - 2].replace('E', '.')
	worlds[0][rowCount - 2] = worlds[0][rowCount - 2].replace('E', 'X')
	worlds[1][rowCount - 2] = worlds[1][rowCount - 2].replace('K', 'X');
	worlds[1][rowCount - 2] = worlds[1][rowCount - 2].replace('K', 'Y');
	worlds[2][rowCount - 2] = worlds[2][rowCount - 2].replace('R', 'Y');
	worlds[2][rowCount - 2] = worlds[2][rowCount - 2].replace('R', '.');

	const centerDist = solveQuest2(worlds[1].map(l => [...l])) + 3 * 2; // start at normal top center, visit both corners, enter both worlds (3*2)
	const bottomLeftDist = solveQuest2(worlds[0].map(l => [...l]), { r: rowCount - 2, c: colCount - 1, }) + 1; // start at bottom right of world
	const bottomRightDist = solveQuest2(worlds[2].map(l => [...l]), { r: rowCount - 2, c: 0 }) + 1; // start at bottom left of world

	return bottomLeftDist + bottomRightDist + centerDist;
}

describe('Part 1', () => {
	test('Example', () => {
		expect(solveQuest(`#####.#####
#.........#
#.######.##
#.........#
###.#.#####
#H.......H#
###########`)).toBe(26)
	})

	test('Notes', () => {
		expect(solveQuest(`#####################.#####################
#.........................................#
############.######.#####.####.############
#.........................................#
####.#.##########################.#.#######
#.........................................#
############.####.#####.#.#################
#.........................................#
###.####.########################.####.####
#.........................................#
#################.#.##.######.#############
#.........................................#
#.#######################################.#
#.#.#.#.#.#.#.................#.#.#...#.#.#
#.#.#...#...#.................#.#.#.#.#.#.#
#...#.#.#.#.#.................#...#...#.#.#
#...#...#...#....###...###....#...#.#.#...#
#.#.#.#.#.#.#...#####.#####...#.#.#.#.#.#.#
#.#.#.#.#.#.#...#####.#####...#.#.#.#.#...#
#.#.#.#...#......###...###....#.#.#.#...#.#
#.#.#.#.#.#.#.....#.....#.......#.#.#.#.#.#
#.#...#.#.#.#.....#.....#.....#.#.#.#.#.#.#
#.#.#.#.#.#.#.................#.#...#...#.#
#.#...#...#.....H.H.H.H.H.H.....#...#.#.#.#
#.#.#.#.#.#.#.................#.#.#.#.#.#.#
###########################################`)).toBe(204)
	})
})

describe('Part 2', () => {
	test('Example', () => {
		expect(solveQuest2(`##########.##########
#...................#
#.###.##.###.##.#.#.#
#..A#.#..~~~....#A#.#
#.#...#.~~~~~...#.#.#
#.#.#.#.~~~~~.#.#.#.#
#...#.#.B~~~B.#.#...#
#...#....BBB..#....##
#C............#....C#
#####################`.split('\n').map(l => [...l]))).toBe(38)
	})

	test('Notes', () => {
		expect(solveQuest2(`##########################################.##########################################
#.A.#.#.#.#.#...#.#.#.#.#.....#.#...#.......#.#...#.#.#...#.#.#.#...#.#...#.....#.A.#
#.A...#...#...#...#.#.#...#.#.#...#...#.#.#.....#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.A.#
#.A.#...#...#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.....#.....#.#.#...#.#.#.#.#...A.#
#.A.#.#.#.#.#.#.#.#.#...#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#...#.#.#.A.#
#.A.#.#.#.#.#...#.#.#.#.#.#...#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.#.A.#
#.A.#.#.#.#.#.#.#...#.#.#...#.#...#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.A.#
#.A.#.#.#.#.#.#...#.#.#...#.#.#.#.#...#...#.#.....#.#.#.#.#.#...#.#.#.#.#.#.#.#...A.#
#.A.#.#...#.#.#.#.#...#.#.#.#.#.#.#.#.#.#.....#.#.#.#.#.#.#...#.........#.#.#.#.#.A.#
#.A.....#.#...#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.#...#...#.#.#.#.#.#.#.#.#.#...#.A.#
#.A.#.#.#.#.#.#.#.#.#...#.#.#.#.#...#...#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.....#.#.A.#
#.A.#.#.#.#.#.#...#.#.#...#.#.#.#.#.#.#.#.#.#.#.....#.#.#...#.#.#.#.#.#.#.#.#.#.#.A.#
#.A.#.#.#...#.#.#...#.#.#.#.#.#...#...#.#.#.#.#.#.#.#.#.#.#.#.#...#.#...#.#.#.#.#.A.#
#.A.#.#.#.#...#.#.#.#.#.#.#...#.#.#.#.#.#...#.#.#.#...#.#.#.#.#.#.#.#.#...#.#.#.#.A.#
#.A.#.....#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.#.#.#...#.#.#...#.#...#.#...A.#
#.A.#.#.#.#.#...#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#...#...#...#.#.#.#.#.#.#.#...#.#.A.#
#.A...#.#...#.#.#.....#.#...#...#...#.#...#...#.#.#.#.#...#.#.......#.#.#.#.#...#.A.#
#################.#################################################.#################
#...#.#.#.#.#.#.#...#.#.#.#.#.#.#.B.B.B.B.B.B.B.B.B.#.#.#.....#.#.#.#.#.#.#.#.#.#...#
#.#...#.#.#.#...#.#.#.#.#.#.#.#.B.B...............B.B.#.#.#.#...#.#.#.#.#...#.#.#.#.#
#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.B.B.....~~~~~~~~~.....B.B.#.#.#.#.#.#.....#.#.#.#.#.#.#
#.#.#.#.#.#.#.#.#.#.#.#...#.#.B....~~~~~~~~~~~~~~~....B.#.#.#.#...#.#.#...#.#.#.#.#.#
#.#.#.#.#.#.#.#.#.#...#.#.#.B.B...~~~~~~~~~~~~~~~~~...B.B.#...#.#.#.#.#.#.#.#.#.#.#.#
#.#...#.#.#.#.#...#.#.#.#.#.B...~~~~~~~~~~~~~~~~~~~~~...B.#.#.#.#.#.#.#.#.#.#...#.#.#
#.#.#...#.....#.#.#.#.#.#.#.B...~~~~~~~~~~~~~~~~~~~~~...B.#.#.#.#...#.#.#.#.#.#...#.#
#.#.#.#...#.#.#.#.#.#.#.#.#.B...~~~~~~~~~~~~~~~~~~~~~...B.#.#.#.#.#.#.#.#.#...#.#.#.#
#.#.#.#.#.#.#.#.#.#.#...#...B.B...~~~~~~~~~~~~~~~~~...B.B.#.#.#.#.#.#.#.#.#.#.#.#.#.#
#.#.#.#.#.#.#...#.#...#...#.#.B....~~~~~~~~~~~~~~~....B.#.#.#...#.#...#.#.#.#.#.#.#.#
#.#.#...#.#.#.#...#.#.#.#.#.#.B.B.....~~~~~~~~~.....B.B.#...#.#...#.#...#.#.#.#...#.#
#.#.#.#.#.....#.#...#.#.#.#.#.#.B.B.B...........B.B.B.#.#.#.#.#.#.#.#.#.#...#...#.#.#
#.#.#.#...#.#.#.#.#.#...#...#.#.#.#.B.B.B.B.B.B.B.#.#.#.#.#.#.#.#...#.#...#...#.#.#.#
#.####################################.#.#.#.#.####################################.#
#.C.#.#...#.#.#.#.#.#.#...#.#.#.....#..#.#.#.#..#.#.#.#.#.#.#.#.#.#...#.#...#.#.#.C.#
#.C.#...#...#.#.#.#.#.#.#.#.#.#.#.#.#...........#.#.......#.#.#...#.#.#...#.#.#...C.#
#.C.#.#.#.#...#...#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.C.#
#.C.#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.#.....#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.C.#
#.C.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.#.#...#.#.#.#.#...#.#.#.#.#.#...#.#.C.#
#.C.#.#.#.#.#.#.#.#.#.#.#.....#.#.#.#.#.#.#...#.#.#.#.#.#...#.#.#.#.#...#.#.#.#.#.C.#
#.C.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.C.#
#.C...#.#.#.#.#.#.#.#...#.#.#.#.#.#...#.#.#.#.#...#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.C.#
#.C.#.#.#.#.#...#.#.#.#.#.#.#.#...#.#.#...#.#.#.#.#.#.#.#.#.....#.#.#.#.#.#.#...#.C.#
#.C.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#...#...#.#.#.#.#.#.#.#.#.#...#.#.C.#
#.C.#.#.#.#.#.#.#.#.#.#...#.#.#.#...#.#.#.#.#.#.#.#...#.....#.#.#.#.#.#.#.#.#.#.#.C.#
#.C.#.#.#.#...#.#.#.#...#.#.#...#.#.#.#.#...#.#...#.#.#.#.#.#.#.#.#.#.....#.#.#.#.C.#
#.C...#.#.#.#.#...#...#.#...#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...C.#
#.C.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#...#.#.#.#.#.#.#.#.C.#
#.C.#...#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.C.#
#.C.#.#.....#.#.#...#.#.#.#...#.#.#.............#.#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.C.#
#.####################################.#.#.#.#.####################################.#
#...#.#.#...#...#.#.#.#.#.#.#.#.#.#.............#...#.#.#.#.#.#...#...#.#...#.......#
#.#.....#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#
#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.#.#...#.#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#
#.#.#.#.#.#.#.#.#.#...#...#...#.#...#.#.#.#.#...#.#...#.#.#...#.#.#.#.#...#...#.#.#.#
#.#.#.#.......#.#...#.#.#.#.#.#.#.#.#.#...#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#
#.#.#.#.#.#.#.#...#.#...#...#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.#
#.#...#.#.#.#...#.#.#.#.#.#.#.....#.#...#.#.#.#...#.#.#.....#.......#...#.#.#...#.#.#
#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.#...#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#
#.#.#...#.#.#.#.#...#.#.#.#.#.#.#...#.#...#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.#...#...#.#
#.#.#.#.#.#.#.#...#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#
#.#.#.#.#.#.#.#.#.#...#.#...#.#.#.#.#...#...#.#.#.#.#.#...#.....#.#.#.#.#.#.#.#.#.#.#
#.#.#.#.#.#...#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.#...#...#.#.#.#.#
#.#.#.#...#.#.#.#.#.#.#.#.#.#...#.#.#.#.#.#...#.#.#.#.#.#...#.#.#.#.#.#...#.#.#.#.#.#
#######################.#####################################.#######################
#.....#.#.#...#.#.#...#...#.#...#.#...............#.#.#.#...#.#.#.#.#.#.#.#.#.#.#...#
#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#......###......#.#.#.#.#.#.#...#.#.#.#.#.#...#.#.#
#.#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#....#######....#...#.#.#...#.#.#.#.#.#.#.#.#.#.#.#
#.#.#.#...#.#.#.....#...#...#.#.#.....#########.....#...#.#.#.#.#...#...#.#...#.#.#.#
#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#.#...#########...#.#.#.#.#.#.#.#.#...#...#.#.#...#.#
#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.#.#....#######....#.#.#.#.#.#.#.#.#.#.#.#...#...#.#.#
#.#.#.#.#.#.#...#.#...#.#.#.#.#...#......###......#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#
#.#.#...#...#.#.#.#.#.#.#...#.#.#.#.......#.......#.#.....#.#...#.#.#.#.#.#.#.#.#.#.#
#.#.#.#.#.#...#.#.#.#.#.#.#.#...#.#.......#.......#...#.#.#.#.#.#.....#.#.#.#.#.#.#.#
#.#...#.#.#.#.#...#.#...#.#...#.#.#.......#.......#.#.#.#.#.#.#...#.#.#.#.#.#.#...#.#
#.#.#.#.#.#.#...#.#.#.#.#.#.#.#...#...............#.#.#.#.#.#.#.#.#.#.....#.#.#.#.#.#
#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.......D.........#.#...#.#...#.#.#.#.#.#...#.#.#.#
#E#.#.#...#.#.#.#...#.#.#.#.#.#.#.................#.#.#.#.#...#.#.#.#.#.#...#.#.#.#E#
#####################################################################################`.split('\n').map(l => [...l]))).toBe(522)
	})
})

describe('Part 3', () => {
	test('Notes', () => {
		expect(solveQuest3(`###############################################################################################################################.###############################################################################################################################
#.A...#.#...#.#.#...#.#.#.#.....#.#.#.#.#...#.#.#.....#.#.#.#.#...#.#...#.#.#.#.#.A.#..G.#...#.#.#.......#.#.......#...#.#.#.....#...#.....#.#.#.#.#.#.#.#.#.#.#.#.#...G..#.N.#.#.#...#.#...#.#.#.....#.......#.#.......#.#.#...#.#.#.....#.#.#...#.#...#...N.#
#.A.#.....#.....#.#.#.#...#.#.#.....#...#.#.#...#.#.#...#.#...#.#.#.#.#.#.#.#.#.#.A..#.G.#.#.#.#.#.#.#.#.....#.#.#.#.#.....#.#.#.#.#.#.#.#.#.#.#.#.#...#.....#...#...#.G.#..N...#.#.#.#...#.#.#...#.#.#.#.#.#.#.#.#.#.#...#.#.#.#.#...#.#.....#.#...#.#.#.#.N.#
#.A.#.#.#.#.#.#...#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.....#...#.#.#.#...#.#.....A.#..G...#...#.#.#.#.#.#.#.#.#.#...#.#.#...#.#.#.#.#.#.#.#.#...#...#...#.#.#.#.#.#.#.G..#.N.#...#.#.#.#.#...#.#.#.#...#.#.#.#.#.#...#.#.#.#.#...#.#.#.#.#.#.#.#.#...#...#.N.#
#.A.#.#.#.#.#.#.#.#.....#.#.#.#.#.#.#.#.#.....#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.A..#.G.#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.G.#..N.#.#.#.#...#.#.#...#.#.#.#.#.#.#.#...#.#.#.#.....#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.N.#
#.A.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#...#.#.#...#.#.#.#.#.#.#.#...#.#.#.....#.#.A.#..G.#.#.#...#.#.#.#.#.#.#.....#.#.#.#.#.#.....#.#...#...#.#.#.#.#.#.#.#...#.#.#...G..#.N.#.#...#.#.#...#.#.#.#.#.#.#.#.#...#.#.#...#.#.#.#.#...#.#.#.#.#...#.#.#.#.#.#.N.#
#.A.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#...#.#.#...#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.#.A..#.G.#.#.#.#.#.....#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#...#.#.#...#.#.#.#...#.#.....#.G.#..N...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.N.#
#.A.#.......#.......#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.....#.#.#.#...#...#.#.#.#.#.#.A.#..G.#...#.#.#.#.#...#.#.#.#.#...#...#...#.#.#.#.#.#.#.#.#...#.#...#.#.#.#.#.#.#.#.G..#.N.#.#.#.#.#.#.#...#.#.#.#...#...#.#.#.#...#.#.#.#.#.#.#.#.#.....#.#.#...#.#.#...N.#
#.A.#.#.#.#...#.#.#.#.#.#...#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.....#.#.#.#.A..#.G...#.#.#.#.#.#.#.....#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.G.#..N.#.#.#...#.#.#.#.#.#.#.#.#.#.#...#...#.#.#.#.#.#.#...#.#...#.#.#.#.#.#.#...#.#.N.#
#.A...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.#...#.#.#...#...#.#.#.#.#.#...#.#.A.#..G.#.#.#.#.#.#.#.#.#.#...#.#.#.#.#...#.#.....#.#.#.#...#.#.#.#.#.#.#.#...#.#.#.#.G..#.N.#...#.#...#.#.#.#.#...#.#.#.#.#...#.#.#.#.#...#.#.#.#...#.#.#...#...#...#...#.N.#
#.A.#.#.#.#.#.#.#.#.#...#.#.#.........#.#.#.#.#...#.#.#.#.#.#.#.#...#.#.#...#...#.A..#.G.#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#...#.#...#.#.#.#.#...#.#.#.G.#..N...#.#.#.#.....#.#...#.#.#...#.#.#.#.#.#.#.#.#...#.#...#.#.#.#.#...#.#.#.#.#.#.N.#
#.A.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.#...#.#...#.#.#.#.#...#.#.#.#.#...#.#.#.#.#...A.#..G.#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.....#.#.#.#...#.#.#.#.#.#.#.#.#.#.G..#.N.#.#...#.#.#.#...#.#.#.#.#.#.#.#.#.#.....#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.N.#
#.A.#.....#.#.#.#.#.#.#...#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.A..#.G.........#.#...#.#...#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.....#.#...#.#.G.#..N.#.#.#.#.#.#.#.#...#.#.....#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.N.#
#.A.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#...#.#.......#.#.#.#.#.#.#.#.#.A.#..G.#.#.#.#.#.#.#.#.#.#.#.#.#...#.....#.#.#.#...#.#.#.#.#.#.#.#...#.#.#.#.#.#...#.G..#.N.#...#...#.#.#.#.#.#.#.#.#.#...#.#...#.#.#.#.#.#.#.#.#.#.#.#.....#.#...#.#.#.#.N.#
#.A.#.#.#.#.#.......#.#.#.#.#.#.#.#.#.#...#.#.#.#...#.#.#.#.#.#...#.#.#.#.......#.A..#.G.#.#.#.#.#.#.#...#.#.....#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#...#.#...#.#.#.#.G.#..N.#.#.#.#...#.#.#.#.#.#.#.#.#.#.....#.#.#.#...#.#.#.......#.#.#.#.#.#.#.#...#.#.N.#
#.A...#.#.#.#.#.#.#.#...#...#.#.#.#...#.#.#...#...#.#.#...#.#.#.#.......#.#.#.#.#.A.#..G.#.#.#.#.#...#.#...#.#.#.#.#.#.#.#.#.#.#...#...#.#...#.#.#.#.#.#.#.#.#...#.#.#.G..#.N.#.#.#.#.#.#.#.#.#...#.#.#...#.#.#.#.#.#.#.#.....#.#.#.#.....#.#...#.#...#...#.N.#
#.A.#.#.#.....#.#.#...#...#.....#...#.#.#...#.#.#.#.#...#.#.#.#.#.#.#.#...#.#.#...A..#.G.#.#.......#.#.#.#.#.#.#.#.#.#.#.#...#...#.#.#.#...#.........#.#...#.#.#...#...G.#..N.#.#...#.#...#.#...#.....#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.#...#.#.#.#...N.#
#################.#################################################.#################.################.#################################################.################.#################.#################################################.#################
#...#.#.#.#...#.#.#.#.#.#.#.#.#.#.B.B.B.B.B.B.B.B.B.#.#.#.#.#.#.#.#.#...#.#...#.#....#...#.........#.#.#.#.#...#.#.#.#.H.H.H.H.H.H.H.H.H.#.#.#...#.#.#.#...#.#.....#.#...#....#.#.#.#...#.#.#.#.#.#.#.#.#.#.O.O.O.O.O.O.O.O.O.#.#.#...#.....#.#.#.#.#.#.#.#...#
#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.B.B...............B.B.#.#.#.#.#.#.#.#.#...#.#.#...#.#..#.#.#.#.#.#.#.#...#.#.#.#.#.#.H.H...............H.H.#.#.#...#.#.#.#...#.#.#.#...#..#.#...#.#...#.#.#.#.#...#...#.#.O.O...............O.O.#.#.#.#.#.#...#...#.#.#.#.#.#.#
#.#...#.#.#.#.#.....#.#.....#.B.B.....~~~~~~~~~.....B.B.#.....#.#.#.#.#.#.#.#.#.#.#..#.#...#.#.#.#...#.#...#.#...#.H.H.....~~~~~~~~~.....H.H.#.#.#.#.#.#.#.#.#.#.#...#.#.#..#.#.#...#.#.#.#.#...#.#.#.#.O.O.....~~~~~~~~~.....O.O.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#
#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.B....~~~~~~~~~~~~~~~....B.#.#.#.#.......#.#...#...#.#.#..#.#.#.#.#.#.#.#.#.#...#.#.#.H....~~~~~~~~~~~~~~~....H.#.#.#.#.#.#.#.#...#.#.#.#.#..#.#.#.#.#.#.#...#.#.#.#.#.#.#.O....~~~~~~~~~~~~~~~....O.#.#.#.#.#.#...#...#.#...#.#.#
#.#.#.#.#.#.#.#.#.#.#.#.#.#.B.B...~~~~~~~~~~~~~~~~~...B.B.#.#...#.#.#.#.#.#.#.#.#.#..#.#.#...#.#.#.#.#.#.#.#.#.#.H.H...~~~~~~~~~~~~~~~~~...H.H.#.#.....#.#.#.#.#.#.#.#.#.#..#.#...#.#.#.#.#...#.#.#.#.O.O...~~~~~~~~~~~~~~~~~...O.O.#...#.#.#.#.#.#.#.#.#...#.#
#.#.#.#...#.#.#.#.#...#.#.#.B...~~~~~~~~~~~~~~~~~~~~~...B.#.#.#.#.#.#.#.#.#.#.#.#.#.#..#.#.#.#.#.#.#.#.#.#.#.#.#.H...~~~~~~~~~~~~~~~~~~~~~...H.#.#.#.#.#.#.#.#.#.#.#...#..#.#.#.#.#.#.#.#...#.#.#.#.#.O...~~~~~~~~~~~~~~~~~~~~~...O.#.#.#...#.#.#.#...#.#.#.#.#
#.#.#.#.#.#.#.#.#...#.#.#.#.B...~~~~~~~~~~~~~~~~~~~~~...B.....#.#.#.#.#.#.#.#.#.#.#..#.#.#.#.#.#.#.#...#.#.#.#.#.H...~~~~~~~~~~~~~~~~~~~~~...H.#.#.#.#.#.#.#.#...#...#.#.#..#...#.#.#.#.#.#.#.#.#.....O...~~~~~~~~~~~~~~~~~~~~~...O.#.#.#.#...#.#.#.#.#.#.#.#.#
#.#.#.#.#.....#...#.#...#.#.B...~~~~~~~~~~~~~~~~~~~~~...B.#.#.#.#.#.#.#.#.#...#.#.#.#..#.#.#.#.#...#.#.#.#...#.#.H...~~~~~~~~~~~~~~~~~~~~~...H.#.#.#.#.#...#.#.#.#.#.#.#..#.#.#.#.#.#.#.#.#.#.#.#.#.#.O...~~~~~~~~~~~~~~~~~~~~~...O...#.#.#.#.#.#.#.#...#.#.#.#
#.#.#...#.#.#.#.#.#.#.#.#.#.B.B...~~~~~~~~~~~~~~~~~...B.B.#.#.#.....#.#.#.#.#.#...#..#.#.#.#.....#.#.#.#...#.#.#.H.H...~~~~~~~~~~~~~~~~~...H.H.#.#.#.#...#...#.#.#.#.#.#.#..#.#...#.#.#.#.#...#.#.#.#.O.O...~~~~~~~~~~~~~~~~~...O.O.#.#.#.#.#.#.#.#.#.#.#.#.#.#
#.#.#.#...#.#.#.#.#.#.#...#.#.B....~~~~~~~~~~~~~~~....B.#.#.#...#.#...#.....#.#.#.#.#..#.#.#.#.#.#.#.#...#.#...#.#.H....~~~~~~~~~~~~~~~....H.#.#.#.#.#.#.#.#.#.#.#.#.#.#..#.#.#.#...#.#...#.#...#.#.#.#.O....~~~~~~~~~~~~~~~....O.#.#...#.#.#...#.#.#.#.#.#.#.#
#.#...#.#.#.#.#.#.#...#.#.#.#.B.B.....~~~~~~~~~.....B.B.#.#.#.#.#.#.#.#.#.#.#.#.#.#..#.#...#.#.#.#...#.#.#.#.#.#.#.H.H.....~~~~~~~~~.....H.H.#.#...#.#.#.#.#.#.#.#.#.#.#.#..#.#.#.#...#.#...#.#.#.#.#.#.O.O.....~~~~~~~~~.....O.O.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#
#.#.#.#.#...#...#.#.#...#...#.#.B.B.B...........B.B.B.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#..#.#.#.#.#.#.#...#.#.#.#...#.#.H.H.H...........H.H.H.#.#.#.#...#.#.#.#.#.#...#.#.#..#.#.#.#.#.#.#.#.#.#.#...#.#.#.#.O.O.O...........O.O.O.#.#.#.#.#.#.#.#...........#.#.#
#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.B.B.B.B.B.B.B.#.#.#.#.#.#.#.#.#.#...#.#.#...#.#..#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.H.H.H.H.H.H.H.#.#.#.#...#.#.....#.#...#.#.#.#.#.#..#.#.#.#.#...#.#.#.#.#...#.#.#.#.#.O.O.O.O.O.O.O.#.#.#.#.#.#...#.#.#.#.#.#.#.#...#.#
#.####################################.#.#.#.#.####################################.#..####################################.#.#.#.#.####################################..#.####################################.#.#.#.#.####################################.#
#.C.....#.#...#.#.#.#.#.#.#.#.#.#.#.#..#.#.#.#..#.#.#...#...#.#...#.#.#.#.#.....#.C..#.I.#.#.#...#.#.#.#.#.#...#.#.#.#.#.#..#.#.#.#..#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.I.#..P.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.#..#.#.#.#..#.....#...#.#.#.#...#.#.#.#.#.....P.#
#.C.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...........#.#.#.#.#.#.#.#.#.#.#.#.....#.#.#.C.#..I.#.#...#.#...#.#.#...#.#.#.#.#.#.#...........#.#...#.#.#.#.#.#.#.#.#.#...#.#.#.I..#.P.#.#.....#.#.#...#.#.#.#...#...#.#...........#.#.#.#.#...#.#.#.#.#.#.#.#...#.#.P.#
#.C.#.#...#.#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.C..#.I.#.#.#.#.#.#.#...#.#.#.#.#.#.#...#.#.#.#.#.#...#.#...#...#.#...#.#.#.#.#.#.#...I.#..P...#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#...#.#.#.#.#.#.#.#.P.#
#.C.#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#...#.#...#.#.#.#.#...#.#.#.#.#.#.#.#.#.#.C.#..I.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.I..#.P.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.P.#
#.C...#.#.#.#.#.#...#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.C..#.I.#...#.#...#.#.#.#.#.#.#.#.#...#...#...#.#.#.#.#.#.#.#.#.....#...#.....#...#.#.I.#..P.#.#.#.#.#.#.#.#.#.#...#.#.#.#.#...#.....#.#.#.#.#.#.#.#.#...#.#.#.#.#...#.#.#.P.#
#.C.#...#.#.#...#.#.#.#.#.#.#.#.#.#.#...#.#...#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.C.#..I.#.#...#.#.#.#.#.#.#.......#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.I..#.P.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.....#.#.#...#.#.#.#.#...#.#.#.#.#.#.#.P.#
#.C.#.#.#.#.#.#.#.#.#.#.#.#.....#.#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.#...#.#.#.#...C..#.I...#.#.#.#.....#.#.#.#.#.#.#.#.#.#.#.#.#...#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.I.#..P.#.#.#.#.#...#.#...#.#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.P.#
#.C.#.#...#.#.#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.#.....#.#...#.#...#.#.#.#.#.#.C.#..I.#.#.#.#.#.#.#.#...#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.#...#.#.#.I..#.P.#.....#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#...#.#.#.#.#.#.#.#.P.#
#.C.#.#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.C..#.I.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#.#...#.#.#.#.#.#.#.#.#.#.....#.I.#..P.#.#.#.#...#.#.#.#.#.#.....#.#...#.#.#.#.#.#.#.#.#.#.#.#.....#.#.#...#.#.#.#.#.P.#
#.C.#.#.#.#.#.#.#...#.#.#...#.#.#.#...#.#.#.#.#...#.#.#.#.#.#.#.#...#.#.#.#...#.#.C.#..I.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#.#...#.#.#.#.#.#.#.#.#.#...#.#...#.#.#.#.#.#.I..#.P.#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#...#.P.#
#.C.#.#.#.#...#...#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.C..#.I.#.#.#.#.#.#.#...#.#.#.#...#.#.#.#.#.#.#.#.#.#...#.#.#.#...#.#.#.#.#.#.#.#.#.#.I.#..P.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#...#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.#.#...#.#.#.P.#
#.C.#.#.#...#...#.#.#.#.#.#.#.#.....#.....#.#...#.#.#.#.#.#.#...#.#.#.#.#...#.#...C.#..I.#...#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...I..#.P.#.#.#.#.#.#.#...#.#.#.#.#...#.#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.P.#
#.C.#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.#.#...#...#.#.#.#.#.#.#.#.#.#...#.C..#.I...#.#.#...#.#.#...#.#...#...#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.I.#..P.#.#.#.#...#.#.#...#.#.#.#.#.#...#...#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#.P.#
#.C.#.#.#.#.#.#.#.#.#...#...#.#.#.#...#.#.#...#.#.#.#.#.#.#.#.#.#.....#.#.#.#.#.#.C.#..I.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.....#.#.#.#.#.#.#...#...#.#.#.#...#...#.#.#.#.#.I..#.P...#.#.#.#.#.#.#.#.......#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.#.P.#
#.C.#.#.#.#.#.#...#...#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#.#...#.#.#.#.#...#.#.#.#.#.C..#.I.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.#...#...#.#...#.#.#.#...#.#.#.#.#.#...#.#.#.#.I.#..P.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#...#...#.#.#.#.#.#.#.#.#.#.#...P.#
#.C.#.#.#...#.#.#.#.#.#...#.#.#.#.#.#...........#.#.#.#.#.#...#.#.#.#.#...#.#.#.#.C.#..I.#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#...........#.#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.I..#.P.#...#...#.#.#.#.#.#.#.#.#.#...#.#...........#.#.#...#.#.#.#.#.#.#...#.#.#.#.#.P.#
#.####################################.#.#.#.#.####################################..#.####################################.#.#.#.#.####################################.#..####################################.#.#.#.#.####################################.#
#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#.#...........#.#.#.#.#...#...#.#.#.#.#.#.#...#.#.#..#.#...#.#.#.#.#.#.#.#.#...#.#.#.#.#...........#.#.#.#.#.#.#.#...#.....#.#.#.#.#.#..#.#.#.#.#.#.#.#.#...#.#.#...#.....#.#...........#.#.#.#...#.#.#...#.#.#.#.#.#.#.#.#.#
#.#.#.#...#.#.#.#.#.#...#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#...#..#.#.#.#.#...#...#.#.#.#.#.#...#.#...#.#.#.#.#.#.#.#.#.#.#.....#.#.#.#.#.#.#.#.#.#.#.#..#.#.....#.#.#...#.#...#.#.#.#.#...#.#.#.#.....#.#.#...#.#.#.#.#...#.#.#.#.#.#.#.#.#
#.#.#.#.#.#.#...#.#...#.#.#.#.#...#.#.#.....#.#.#.#...#...#...#.#...#.#...#.#.#.#.#.#..#...#.#.#.#.#.....#.#...#.#...#.#.#.#...#.#.#.#.....#.#.#.#...#.#.#.#.#.#...#.#.#..#.#...#.#.#.#.#.#.#.#.#...#.#.#.#.#...#.#...#.#.#.#...#.#.#...#.#.#.#...#.#.#.#.#.#.#
#.#.#...#.....#.#...#.#...#.#.#.#.#.#...#.#.....#.#.#...#.#.#.#.#.#.#.#.#.#...#.#.#..#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#...#.#.#.#.#.#.#.#.#.#.#.#.#...#.#.....#.#...#.#..#.#.#.#...#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.#...#.#.#.#.#.#...#.#...#.#.#
#.#...#.#.#.#.#...#.#.#.#.#.#.#.#...#.#.#.#.#.#.#...#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.#..#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#...#.#...#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#..#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.....#.#.#.#...#.#.#.#.#.#.#.#.#.#.#...#.#...#.#
#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.#..#.#.#.#.#.#.#...#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#.#...#.#.#.#.#.#.#.#.#.#..#.#.#...#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.#.#...#.#...#.#.#.#.#.#.#.#.#.#.#
#...#.#.#.#.#.#.#.#.#.#.#.#.....#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.#.#...#....#.#.....#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.#.#...#.#...#.#...#.#.#.#.#.#.#.#...#....#...#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#...#
#.#.#.#.#.#.#.#.#.#...#.#.#.#.#...#.#.#.#.#.#.#.#.#.#...#.#.#...#.#.#.#.#.#.#.#.#.#..#.#...#.#.#.#.#...#.#.#.#.#.#.#.#...#.....#.#.#.#.#.#.#.#.#.#...#.#.#.#.#...#.#.#.#.#..#.#.#.#.....#.#.#...#.#.#...#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.#
#.#...#.#.....#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.#.#.....#.#.#.#...#.#.#.#..#.#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#..#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.....#.#...#.#
#.#.#.....#.#...#.#.#.#.#.#.#.#.#.#.#.#.#...#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#..#.#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#..#.#.#.#.#.#.#.#.#.#...#.#.#.#.#.#...#.#.#.#...#.#.#...#.#.#.#.#.#.#.#.#.#.#...#.#.#
#.#.#.#.#.#.#.#.#...#.#...#.#.#.#.#.#.#...#.#.#...#.#.#.#.#...#.#.#.#.#...#.#.#...#.#..#.#.#.#.#.#.#.#...#...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.....#.#.#.#...#.#...#...#.#.#..#.#.#.#.#.#.#.#...#.#.#.....#.#.#.#.#.#.#...#.#.#.#.#.#.#...#...#.#.#.#.#.#.#.#.#.#.#
#.#.#.#.#.#.#.#...#.#...#.#...#.#...#...#.#...#.#.#.#.#.#.#.#.#.#.#.....#.#.#...#.#..#.#.#.#.#.#.#.#.#.#.#.#.#.......#.#.#.#.#.#.#...#...#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#..#.#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#...#.#...#.#.#.#.#.#.#.#.#
#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.#...#.#.#.#.....#.#.#.#.#.#.#...#.#.#.#.#..#.#.....#...#.#.#.#.#.#.#.#.#...#...#.#.#.#.#...#...#.#.#.#.#.#.#.....#.#.#...#.#..#.#...#.#.#.#...#.#...#.#.#.........#.#.#.#.#.#.#...#.#.#.#.#.#...#.....#.#...#.#.#.#
#######################.#####################################.######################.#######################.#####################################.#######################.######################.#####################################.#######################
#...#.#...#.#.#...#.#.#.#.#.#.#.#.#.................#...#.#.#.#.#.#.#.....#.#...#...#......#.#.#.#.#.#.#.#...#.#.#.#...#...............#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#....#.....#.#.#.#.....#...#.#.#.#.#.#.#...............#.#.#.#.#...#.#.#...#.#.#.#.#.#...#
#.#.#.#.#.#.#...#...#.#.#.#...#.#.#......###......#.#.#.#.....#.#.#.#.#.#.#.#.#.#.#..#.#.#.#.#.#...#.#.#.#.#.#.#.#...#.#......###......#.#...#.#.#.#...#.#.#.#...#.#.#.#.#..#.#.#.#.#.#.#.#.#.#.#.#...#.#...#......###......#.#.#.#.#.#.#.#.#.#...#.#...#.#.#.#
#.#.#...#.#.#.#.#.#.#...#.#.#.#.#.#....#######....#.#.#.#.#.#...#.#.#.#.#.....#.#.#.#..#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#....#######....#.#.#.#.#.#.#.#.#.#...#.#.#.#.#.#..#.#.#.......#.#.#...#.#.#.#.#.#.#.#....#######....#.#.#.#.#.#...#.#.#.#...#.#.#.#.#.#
#.#.#.#.#.#...#.#.#...#.#.#.#.#.#.#...#########...#...#.#.#.#.#.#...#.#.#.#.#.#.#.#..#.#.#.#.#.#.#.#...#...#.#...#.#.#.#...#########...#.#.#.#.#.#...#.#.#.#.#.#.#.#...#.#..#.#.#.#.#.#.#.#.#.#.#...#...#.#.....#########.........#...#.#...#.#.#.#.#.#.....#.#
#.#...#.#.#.#.#.#.#.#.#.#...#.#...#...#########...#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#..#.#.#...#.#...#...#.#...#.#.#.#.#...#########.....#.#.#.#.#.#.#.#.#.#...#.#.#.#.#..#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#.#...#########...#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.#
#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#......#######....#.#...#.#.#.#.#.#.#.#.#.#.#.#.#.#..#.#.#.#.#.#...#.#.#.#.#.#.#...#.#.#....#######....#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#..#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#....#######....#.#.#.#.#...#.#.#.#.#.#.#.#.#.#.#.#
#.#.#.#.#...#.#.#.#.#...#.#.#.#.#.#......###......#.#.#.#.#.#.#.#.#...#.#.#.#.#...#.#..#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#........###......#.#...#.#...#.#.#.#.#.#.#.#.#.#.#..#.#.#.#...#.#.#.#.#...#.#.#.#.#.#.#......###......#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#
#.#.#.#.#.#.#.#.#.#.#.#...#.#.#.#.#.......#.......#.#.#...#.#.#...#.#.#.#.#.#.#.#.#..#.#.#...#.#.#.#...#.#.#.#.#.#...#.#.......#.......#.#.#.....#.#.#.#...#.#...#.#...#.#..#...#.#.#...#.#.#.#.#.#.#.#.#.#.#.......#.......#.#.....#.#...#.#.#.#.#.#.#.#.#.#.#
#.#...#.#.#.#.#.#.#.#.#.#...#.#.#.#.......#.......#...#.#.#.#.#.#.#.#.#...#.#.#.#.#.#..#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.......#.......#...#.#.#.#.#.#.#.#.#.#.#.....#.#..#.#.#.#.#.#.#.#...#.#.....#...#.#.#.......#.......#.#.#.#.#.#.#...#.#.#.#...#.#.#.#.#
#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.......#.........#.#.#.#.#.#.#...#.#.#.#...#.#.#..#.#.#.#.#...#...#.#.#.#...#.#.#...#.......#.......#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.#.#..#.#...#.#.#.#.#.#.#.#.#...#.#.#.#.......#.......#.#.#.#...#.#.#.#.#.....#.#...#.#.#
#.#.#...#.#.#.....#.#.#.#.#.#.....................#.#.#.#.#.#.#.#.#.#.#.#...#...#.#.#..#.#.#...#.#.#.#...#.#.#.#...#.#.................#.#.#.#.#.#.#.#.#.#...#.#.#.#.#.#..#.#.#.#.#...#...#.#.#.#.#.#.#...#.................#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#
#.#.#.#.#.....#.#.#.#.#.#.#...#.#.#.......D.......#.#.#.#.......#.#.....#.#.#.#.#.#..#.#.....#.#.#.#.#.#.#...#...#.#.#.#.......J.......#.#.#.#...#.#.......#.#.#.#.#.#.#.#..#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.......Q...........#...#.#.#.#...#.#.#.#.#.#...#.#
#E#.#.#...#.#.#.#.#...#...#.#.#.#.#...............#.#.#...#.#.#...#.#.#.#.#.#.#...#E..K#.#.#.#.#.#.#.#.#...#.#.#.#.#.#.#...................#...#...#.#.#.#.#...#.....#.#K..R#.#.#.#.#...#.#.#.#...#.#.#.#.#.#...............#.#.#.#.#.#.#.#.#.#.#.#.....#.#.#R#
###############################################################################################################################################################################################################################################################`)).toBe(1550)
	})
})
